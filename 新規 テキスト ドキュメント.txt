パックがマレットにあたって跳ね返る処理
2022/06/25 1:29 やっとできたー－－－
回転角の回転方向の概念を考えることによって、やっと正確な数式処理を書くことができた。
正直最後は祈るばかりだった。今後数式処理をするときには気を付けよう

次は相対速度を実装してみよう。そうすればめり込み減少も少なくなる（はず）
相対速度を実装すると、マレットの速さがとんでもないことになるので、摩擦も実装しよう。

相対速度を実装するため、マレットの速さを一定にしたい（斜め移動を遅くしたい）が、左上移動を遅くすると、←↑→を同時押ししたときに、↑の入力が二回分になってしまう。
これをどうにかしないといけない。

バウンドすればするほど加速するのは反発係数を考慮していないからである
反発係数はマレットと壁で別々とする（自由度を高めておく。今の時点ではどちらも同じ値）

また、マレットがパックをステージ外へ押し出さないようにした。

まぁ、妥協できる動作にはなった。あとは敵や弾幕などの実装

弾幕の実装。いろんなクラスで他クラスの参照を行うので、だんだんコードが複雑になってきた。
今回手間取ったエラーはC２０６１。こいつに出会ったのはこれで二度目だが、一時間ほどコードとの睨めっこが続いた。
他クラスのヘッダーファイルのインクルードをCPPファイルで行っているのが原因だった。インクルードをヘッダーファイルに移すと、解決した。

ショットボールの中の処理
for (auto itB_1 = enebullets.begin(); itB_1 != enebullets.end();)
		{
			if (itB_1->GeneTimer == 0)
			{
				/*ball->shot(itB_1->pos, itB_1->dir, Speed);
				ball->shot(itB_1->pos, itB_1->dir + 3.14 / 12, Speed/3);
				ball->shot(itB_1->pos, itB_1->dir - 3.14 / 12, Speed/3);*/
			}
		}
どうやらこの処理の繰り返しが終わらないらしい。あ、イテレータをインクリメントしてなかった！無事解決した。
siv3dがフリーズし、ウィンドウを閉じることができないということがたびたびあったが、どうやらそれは、プログラムが無限ループを起こしているのが原因みたいだ。
終了処理がしっかり行われるかどうかをチェックしろ！！

まだ終了処理を書けてないやつがいるみたいだ。GeneBullet_1だという検討はついている。しかし、Genebulletの中を見てみると、イテレータはしっかりとインクリメントされている。さて困った。ｈ
しかし構造的にはショットボールとほぼ同じ。ショットボールはイテレータをインクリメントして解決したのに、なぜ、こいつは動いてくれない……ん、まてよ。フォー文の前にGeneTimerCountとかいう関数があるぞ……まさか、こいうつの中に……
定義に移動してみると、ビンゴ！！
イテレータのインクリメント忘れには注意しよう。

